# æµ‹è¯•æŒ‡å—

## ðŸ“‹ æµ‹è¯•ç±»åž‹

### 1. å•å…ƒæµ‹è¯•

æµ‹è¯•å•ä¸ªå‡½æ•°æˆ–æ¨¡å—çš„åŠŸèƒ½ã€‚

**è¿è¡Œ**:
```bash
go test ./internal/protocol/...
go test ./internal/snat/...
```

**è¦†ç›–çŽ‡**:
```bash
go test -cover ./...
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out
```

---

### 2. é›†æˆæµ‹è¯•

æµ‹è¯•å¤šä¸ªæ¨¡å—ååŒå·¥ä½œã€‚

**è¿è¡Œ**:
```bash
go test -v ./tests/integration/...
./tests/integration/run_integration_test.sh
```

**æµ‹è¯•å†…å®¹**:
- åŠ å¯†å¾€è¿”æµ‹è¯•
- å¹¶å‘åŠ å¯†æµ‹è¯•
- IPé€‰æ‹©ç­–ç•¥æµ‹è¯•
- SNATåŠŸèƒ½æµ‹è¯•ï¼ˆéœ€è¦rootï¼‰

---

### 3. æ€§èƒ½æµ‹è¯•

æµ‹è¯•ç³»ç»Ÿæ€§èƒ½å’Œåžåé‡ã€‚

**è¿è¡Œ**:
```bash
go test -bench=. -benchmem ./tests/performance/...
./tests/performance/benchmark.sh
```

**æµ‹è¯•å†…å®¹**:
- åŠ å¯†åžåé‡
- è§£å¯†åžåé‡
- å¹¶å‘æ€§èƒ½
- å†…å­˜ä½¿ç”¨

---

## ðŸ”§ æµ‹è¯•å·¥å…·

### Goæµ‹è¯•å·¥å…·

```bash
# åŸºæœ¬æµ‹è¯•
go test ./...

# è¯¦ç»†è¾“å‡º
go test -v ./...

# è¦†ç›–çŽ‡
go test -cover ./...

# åŸºå‡†æµ‹è¯•
go test -bench=. -benchmem ./...

# å¹¶è¡Œæµ‹è¯•
go test -parallel 4 ./...
```

### åŽ‹åŠ›æµ‹è¯•

```bash
# ä½¿ç”¨wrkè¿›è¡ŒHTTPåŽ‹åŠ›æµ‹è¯•
wrk -t12 -c400 -d30s http://localhost:8080/api/stats

# ä½¿ç”¨abè¿›è¡ŒåŽ‹åŠ›æµ‹è¯•
ab -n 10000 -c 100 http://localhost:8080/api/stats
```

---

## ðŸ“Š æµ‹è¯•æŠ¥å‘Š

è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
make test-coverage
```

---

## âœ… æµ‹è¯•æ¸…å•

åœ¨æäº¤ä»£ç å‰ç¡®ä¿ï¼š

- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•æ— å›žå½’
- [ ] ä»£ç è¦†ç›–çŽ‡ > 80%
- [ ] æ— linté”™è¯¯
- [ ] æ–‡æ¡£å·²æ›´æ–°

